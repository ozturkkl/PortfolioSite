<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">

    <title>K.Ozturk</title>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Syne+Mono&display=swap');
    </style>

    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
</head>

<body>
    <main>
        <section class="landing">
            <div id="typed-strings" style="display: none;">
                <p>Welcome...^1000</p>
                <p>I hope you're having a great day.^1000</p>
                <p>Who am I?^1000</p>
                <p><strong>Kemal Ozturk</strong></p>
            </div>
            <a href="index.html" class="greet">
                <span id="greet"></span>
            </a>
            <img class="portrait" src="images/other/kemal.jpg">
            <nav>
                <h2>where to?</h2>
                <ul>
                    <li><a href="#projects">Projects</a></li>
                    <li><a href="#links">Links</a></li>
                    <li><a href="https://drive.google.com/file/d/1lwvI9qY3qZwaHCGMgi0RgH0HgcW2FEf0/view?usp=sharing"
                            target="_blank">Resume</a></li>
                </ul>
            </nav>
        </section>
        <section id="projects">
            <h1>Projects</h1>
            <div class="projects-container"></div>
            <template>
                <a target="_blank">
                    <div class="project">
                        <h2 id="title"></h2>
                        <h3 id="language"></h3>
                        <p id="description"></p>
                    </div>
                </a>
            </template>
        </section>
        <section id="links">
            <h1>Links</h1>
            <template>
                <a target="_blank">
                </a>
            </template>
            <p>Under Construction...</p>
        </section>
    </main>
    <div class="back-top"></div>
    <footer>
        Kemal Ozturk Portfolio Website<br>
        Email me at <a href="mailto:97kemalozturk@gmail.com">97kemalozturk@gmail.com</a>
    </footer>
</body>

<script>
    scrollOff()


    const portrait = document.querySelector('.portrait')
    const greet = document.querySelector('.greet')
    const projectTemplate = document.querySelector('#projects template')
    const projects = document.querySelector('#projects .projects-container')
    const backTop = document.querySelector('.back-top')
    const windowLocationHash = (window.location.hash) ? document.querySelector(window.location.hash) : window.body


    var options = {
        stringsElement: '#typed-strings',
        typeSpeed: 35,
        startDelay: 400,
        backSpeed: 10,
        smartBackspace: true,
        backDelay: 0,

        onComplete: () => {
            portrait.classList.add('fade-in')
            portrait.classList.add('slide-left')
            greet.classList.add('slide-right')
            greet.classList.add('big')
        }

        // fadeOut: true,
        // fadeOutClass: 'typed-fade-out',
        // fadeOutDelay: 1500,
    };
    var typed = new Typed('#greet', options);


    fetch('https://api.github.com/users/ozturkkl/repos')
        .then(response => response.json())
        .then(data => {
            Promise.all(data.map(project => {
                return new Promise((res, rej) => {
                    const readme = `https://raw.githubusercontent.com/ozturkkl/${project.name}/master/README.md`
                    const projectTemplateNode = projectTemplate.content.cloneNode(true)

                    fetch(readme)
                        .then(response => response.text())
                        .then(async data => {
                            let imageURL = data.match(/!\[.+\]\((.+)\)/)
                            if (imageURL && imageURL[1]) {
                                imageURL = imageURL[1]

                                let imgElement = await loadImage(imageURL)
                                projectTemplateNode.querySelector('.project').appendChild(imgElement)
                            }

                            projectTemplateNode.querySelector('a').setAttribute('href', project.html_url)
                            projectTemplateNode.querySelector('#title').innerText = project.name
                            projectTemplateNode.querySelector('#language').innerText = project.language
                            projectTemplateNode.querySelector('#description').innerText = project.description

                            projects.append(projectTemplateNode)
                            res()
                        })
                })
            })).then(() => {
                scrollOn()

                windowLocationHash.scrollIntoView()
            })
        });


    window.addEventListener('scroll', e => {
        if (document.documentElement.scrollTop > 500) {
            backTop.classList.add('visible')
        }
        if (document.documentElement.scrollTop < 500) {
            backTop.classList.remove('visible')
        }
    })
    backTop.addEventListener('click', () => {
        window.scrollTo(0, 0);
    })


    function disableScroll(e) {
        e.preventDefault();
        window.scrollTo(0, 0);
    }
    function scrollOff() {
        document.body.addEventListener('dragstart', (e) => {
            e.preventDefault()
        })
        document.body.style.overflow = "hidden"
        window.addEventListener('scroll', disableScroll)
    }
    function scrollOn() {
        window.removeEventListener('scroll', disableScroll)
        document.body.style.overflow = "visible"
        setTimeout(() => {
            document.body.parentElement.style.scrollBehavior = "smooth"
        }, 0);
    }
    function loadImage(src) {
        return new Promise((resolve, reject) => {
            const img = new Image();
            img.onload = () => resolve(img);
            img.onerror = reject;
            img.src = src;
        })
    }
</script>


</html>